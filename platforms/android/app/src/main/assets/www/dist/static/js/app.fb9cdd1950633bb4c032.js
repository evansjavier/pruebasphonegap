webpackJsonp([1],{"8J1Y":function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("7+uW"),a=s("//Fk"),i=s.n(a),o={computed:{isLoggedIn:function(){return this.$store.getters.isLoggedIn}},methods:{logout:function(){var e=this;this.$store.dispatch("logout").then(function(){e.$router.push("/login")})}},created:function(){this.$http.interceptors.response.use(void 0,function(e){return new i.a(function(t,s){throw 401===e.status&&e.config&&!e.config.__isRetryRequest&&this.$store.dispatch(logout),e})})}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("nav",{staticClass:"navbar navbar-expand-md navbar-light bg-white shadow-sm"},[s("div",{staticClass:"container"},[s("router-link",{staticClass:"navbar-brand",attrs:{to:{path:"/schedule"}}},[s("img",{staticClass:"d-inline-block",attrs:{src:"https://dataprolegal.com/wp-content/uploads/2018/06/Logo-comunidad_3.png",width:"auto",height:"45px"}})]),e._v(" "),e._m(0),e._v(" "),s("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarSupportedContent"}},[s("ul",{staticClass:"navbar-nav mr-auto"},[e.isLoggedIn?s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{to:{path:"/schedule-records-index"}}},[e._v("\n                          Fichas\n                        ")])],1):e._e()]),e._v(" "),s("ul",{staticClass:"navbar-nav ml-auto"},[e.isLoggedIn?s("li",{staticClass:"nav-item dropdown"},[e._m(1),e._v(" "),s("div",{staticClass:"dropdown-menu dropdown-menu-right",attrs:{"aria-labelledby":"navbarDropdown"}},[s("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.logout(t)}}},[e._v("\n                                  Cerrar sesión\n                              ")])])]):s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{to:{name:"login"}}},[e._v("\n                            Login\n                          ")])],1)])])],1)]),e._v(" "),s("main",{staticClass:"py-4"},[s("div",{staticClass:"container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-8 offset-md-2"},[s("div",{staticClass:"alert-container"}),e._v(" "),s("router-view")],1)])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"}},[t("span",{staticClass:"navbar-toggler-icon"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("a",{pre:!0,attrs:{id:"navbarDropdown",class:"nav-link dropdown-toggle",href:"#",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[this._v("\n                              USERNAME "),t("span",{pre:!0,attrs:{class:"caret"}})])}]};var l=s("VU/8")(o,n,!1,function(e){s("8J1Y")},null,null).exports,c=s("/ocq"),d=s("NYxO"),u=s("mtWM"),m=s.n(u);r.a.use(d.a);var _=new d.a.Store({state:{status:"",token:localStorage.getItem("token")||"",user:{}},mutations:{mutations:{auth_request:function(e){e.status="loading"},auth_success:function(e,t,s){e.status="success",e.token=t,e.user=s},auth_error:function(e){e.status="error"},logout:function(e){e.status="",e.token=""}}},actions:{login:function(e,t){var s=e.commit;return new i.a(function(e,r){s("auth_request"),m()({url:API.login,data:t,method:"POST"}).then(function(t){var r=t.data.access_token,a=t.data.user;localStorage.setItem("token",r),m.a.defaults.headers.common.Authorization="Bearer "+r,s("auth_success",r,a),e(t)}).catch(function(e){s("auth_error"),localStorage.removeItem("token"),r(e)})})},logout:function(e){var t=e.commit;return new i.a(function(e,s){t("logout"),localStorage.removeItem("token"),delete m.a.defaults.headers.common.Authorization,e()})}},getters:{isLoggedIn:function(e){return!!e.token},authStatus:function(e){return e.status}}}),v={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h1",[this._v("The Home")])])}]},p=s("VU/8")(null,v,!1,null,null,null).exports,h={data:function(){return{email:"",password:"",remember_me:"",errors:{email:[],password:[],remember_me:[]}}},methods:{login:function(){var e=this,t=this.email,s=this.password;this.$store.dispatch("login",{email:t,password:s}).then(function(){return e.$router.push("/schedule")}).catch(function(e){return console.log(e)})}}},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header"},[e._v("Acceder")]),e._v(" "),s("div",{staticClass:"card-body"},[s("form",{on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-md-4 col-form-label text-md-right",attrs:{for:"email"}},[e._v("Correo electrónico")]),e._v(" "),s("div",{staticClass:"col-md-6"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"form-control",class:{"is-invalid":e.errors.email.lenght},attrs:{id:"email",type:"email",name:"email",required:"",autocomplete:"email",autofocus:""},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._v(" "),e._l(e.errors.email,function(t){return s("span",{staticClass:"invalid-feedback",attrs:{role:"alert"}},[s("strong",[e._v(e._s(e.$error))])])})],2)]),e._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-md-4 col-form-label text-md-right",attrs:{for:"password"}},[e._v("Contraseña")]),e._v(" "),s("div",{staticClass:"col-md-6"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",class:{"is-invalid":e.errors.password.lenght},attrs:{id:"password",type:"password",name:"password",required:"",autocomplete:"current-password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),e._l(e.errors.email,function(t){return s("span",{staticClass:"invalid-feedback",attrs:{role:"alert"}},[s("strong",[e._v(e._s(e.$error))])])})],2)]),e._v(" "),s("div",{staticClass:"form-group row"},[s("div",{staticClass:"col-md-6 offset-md-4"},[s("div",{staticClass:"form-check"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.remember_me,expression:"remember_me"}],staticClass:"form-check-input",attrs:{type:"checkbox",name:"remember",id:"remember"},domProps:{checked:Array.isArray(e.remember_me)?e._i(e.remember_me,null)>-1:e.remember_me},on:{change:function(t){var s=e.remember_me,r=t.target,a=!!r.checked;if(Array.isArray(s)){var i=e._i(s,null);r.checked?i<0&&(e.remember_me=s.concat([null])):i>-1&&(e.remember_me=s.slice(0,i).concat(s.slice(i+1)))}else e.remember_me=a}}}),e._v(" "),s("label",{staticClass:"form-check-label",attrs:{for:"remember"}},[e._v("\n                                        Recuérdame\n                                    ")])])])]),e._v(" "),e._m(0)])])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"form-group row mb-0"},[t("div",{staticClass:"col-md-8 offset-md-4"},[t("button",{staticClass:"btn btn-primary"},[this._v("\n                                    Acceder\n                                ")])])])}]};var g=s("VU/8")(h,f,!1,function(e){s("wbng")},null,null).exports,C={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h1",[this._v("This page is protected by auth")])])}]},b=s("VU/8")(null,C,!1,null,null,null).exports,x=s("woOf"),w=s.n(x),y=s("pFYg"),k=s.n(y),$=s("7t+N"),E=s.n($),P={watch:{status:function(){console.log(this.status)},schedule_record:{handler:function(){1==this.schedule_record.executed&&(this.schedule_record.motive_id=null,this.schedule_record.motive_details=null,this.submitSignIn())},deep:!0}},data:function(){return{status:"initial",errors:{executed:[],motive_id:[],motive_details:[],entry_time:[],departure_time:[],sec_entry_time:[],sec_departure_time:[]},schedule_record:{executed:null,motive_id:"",motive_details:null,entry_time:null,departure_time:null,sec_entry_time:null,sec_departure_time:null},info:{current_date:"",hours:""},message:"",motive_list:[]}},mounted:function(){var e=this;axios.get("schedule-records/today").then(function(t){var s=t.data;"undefined"==k()(s.id)?(e.status="ready",e.fillMotives(),e.schedule_record=w()(e.schedule_record,{entry_time:s.schedule_entry_time,departure_time:s.schedule_departure_time,sec_entry_time:s.sec_schedule_entry_time,sec_departure_time:s.sec_schedule_departure_time})):e.status="sent",e.info=w()(s,{current_date:s.date,hours:s.schedule})}).catch(function(t){switch(e.status="fatal-error",t.response.status){case 400:case 403:e.message=t.response.data.message;break;default:e.message="Ha ocurrido un error inesperado, si este persiste contacte con el administrador del sistema."}})},methods:{expandDetails:function(){var e=E()("#schedule_record_motive").find('option[value="'+this.schedule_record.motive_id+'"]'),t=E()("#schedule_record_more_details");e.length>0&&e.attr("need_details")>0?t.parents(".more-details-container").slideDown():t.parents(".more-details-container").slideUp()},submitSignIn:function(){var e=this;e.status="submitting",e.resetErrors();var t=new URLSearchParams;t.append("executed",e.schedule_record.executed?e.schedule_record.executed:""),t.append("motive_id",e.schedule_record.motive_id?e.schedule_record.motive_id:""),t.append("motive_details",e.schedule_record.motive_details?e.schedule_record.motive_details:""),t.append("entry_time",e.schedule_record.entry_time?e.schedule_record.entry_time:""),t.append("departure_time",e.schedule_record.departure_time?e.schedule_record.departure_time:""),t.append("sec_entry_time",e.schedule_record.sec_entry_time?e.schedule_record.sec_entry_time:""),t.append("sec_departure_time",e.schedule_record.sec_departure_time?e.schedule_record.sec_departure_time:""),axios.post("sign-on",t).then(function(s){E()("#motiveModal").modal("hide"),E()("#successModal").modal(),e.status="sent",console.log(t)}).catch(function(t,s){switch(e.status="error",t.response.status){case 422:e.errors=w()(e.errors,t.response.data.errors);break;default:alert("Ha ocurrido un error inesperado, si el error persiste contacta con el administrador del sistema.")}})},fillMotives:function(){var e=this,t=[];axios.get("motive/list").then(function(e){t=e.data}).catch(function(e){e.response.status,t={id:null,title:"Ocurrio un error al buscar los motivos de tu empresa.",need_details:!1}}).then(function(){e.motive_list=t})},hasError:function(e){return this.errors[e]&&this.errors[e].length>0},resetErrors:function(){var e={};for(var t in this.errors)e[t]=[];this.errors=w()(this.errors,e)}}},N={render:function(){var e=this,t=this,s=t.$createElement,r=t._self._c||s;return r("div",{staticClass:"text-center"},[r("div",{},[r("div",{directives:[{name:"show",rawName:"v-show",value:-1!=["ready","submitting","error"].indexOf(t.status),expression:"['ready', 'submitting', 'error'].indexOf(status) != -1 "}],staticClass:"card-body"},[r("div",{staticClass:" text-center"},[r("h2",[t._v(t._s(t.info.current_date))]),t._v(" "),r("p",{staticClass:"lead mb-2"},[t._v("¿Ha realizado este horario?")]),t._v(" "),r("p",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t.info.hours))]),t._v(" "),r("div",{staticClass:"row justify-content-center"},[r("div",{staticClass:"col-auto"},[r("label",{staticClass:"btn btn-success exec-btn"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.executed,expression:"schedule_record.executed"}],attrs:{type:"radio",value:"1"},domProps:{checked:t._q(t.schedule_record.executed,"1")},on:{change:function(e){return t.$set(t.schedule_record,"executed","1")}}}),t._v("\n                            Si\n                        ")])]),t._v(" "),r("div",{staticClass:"col-auto"},[r("label",{staticClass:"btn btn-danger exec-btn",attrs:{"data-toggle":"modal","data-target":"#motiveModal"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.executed,expression:"schedule_record.executed"}],attrs:{type:"radio",value:"0"},domProps:{checked:t._q(t.schedule_record.executed,"0")},on:{change:function(e){return t.$set(t.schedule_record,"executed","0")}}}),t._v("\n                            No\n                        ")])]),t._v(" "),r("div",{staticClass:"col-12"},[r("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.errors.executed[0])}})])])]),t._v(" "),r("div",{staticClass:"modal fade",attrs:{id:"motiveModal",tabindex:"-1",role:"dialog","aria-labelledBy":"motiveModal","aria-hidden":"true"}},[r("div",{staticClass:"modal-dialog ",attrs:{role:"document"}},[r("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),r("div",{staticClass:"modal-body"},[r("div",{staticClass:"form-group"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.motive_id,expression:"schedule_record.motive_id"}],class:"form-control "+(t.hasError("motive_id")?"is-invalid":""),attrs:{id:"schedule_record_motive"},on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.$set(t.schedule_record,"motive_id",e.target.multiple?s:s[0])},function(e){return t.expandDetails()}]}},[r("option",{attrs:{value:"",disabled:""}},[t._v("Seleccione un motivo")]),t._v(" "),t._l(t.motive_list,function(e){return r("option",{attrs:{need_details:e.need_details?1:0},domProps:{value:e.id}},[t._v(t._s(e.title))])})],2),t._v(" "),r("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.errors.motive_id[0])}})]),t._v(" "),r("div",{staticClass:"more-details-container",staticStyle:{display:"none"}},[r("div",{staticClass:"form-group row text-left"},[t._m(1),t._v(" "),r("div",{staticClass:"col"},[r("label",[t._v("Hora de entrada")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.entry_time,expression:"schedule_record.entry_time"}],class:"form-control form-control-sm "+(t.hasError("entry_time")?"is-invalid":""),attrs:{type:"time",placeholder:"00:00",required:""},domProps:{value:t.schedule_record.entry_time},on:{input:function(e){e.target.composing||t.$set(t.schedule_record,"entry_time",e.target.value)}}}),t._v(" "),r("span",{staticClass:"text-danger small",domProps:{textContent:t._s(t.errors.entry_time[0])}})]),t._v(" "),r("div",{staticClass:"col"},[r("label",[t._v("Hora de salida")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.departure_time,expression:"schedule_record.departure_time"}],class:"form-control form-control-sm "+(t.hasError("departure_time")?"is-invalid":""),attrs:{type:"time",placeholder:"00:00",required:""},domProps:{value:t.schedule_record.departure_time},on:{input:function(e){e.target.composing||t.$set(t.schedule_record,"departure_time",e.target.value)}}}),t._v(" "),r("span",{staticClass:"text-danger small",domProps:{textContent:t._s(t.errors.departure_time[0])}})])]),t._v(" "),t.info.sec_schedule_entry_time&&t.info.sec_schedule_departure_time?r("div",{staticClass:"form-group row text-left"},[t._m(2),t._v(" "),r("div",{staticClass:"col"},[r("label",[t._v("Hora de entrada")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.sec_entry_time,expression:"schedule_record.sec_entry_time"}],class:"form-control form-control-sm "+(t.hasError("sec_entry_time")?"is-invalid":""),attrs:{type:"time",placeholder:"00:00",required:""},domProps:{value:t.schedule_record.sec_entry_time},on:{input:function(e){e.target.composing||t.$set(t.schedule_record,"sec_entry_time",e.target.value)}}}),t._v(" "),r("span",{staticClass:"text-danger small",domProps:{textContent:t._s(t.errors.sec_entry_time[0])}})]),t._v(" "),r("div",{staticClass:"col"},[r("label",[t._v("Hora de salida")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.sec_departure_time,expression:"schedule_record.sec_departure_time"}],class:"form-control form-control-sm "+(t.hasError("sec_departure_time")?"is-invalid":""),attrs:{type:"time",placeholder:"00:00",required:""},domProps:{value:t.schedule_record.sec_departure_time},on:{input:function(e){e.target.composing||t.$set(t.schedule_record,"sec_departure_time",e.target.value)}}}),t._v(" "),r("span",{staticClass:"text-danger small",domProps:{textContent:t._s(t.errors.sec_departure_time[0])}})])]):t._e(),t._v(" "),r("div",{staticClass:"form-group"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.motive_details,expression:"schedule_record.motive_details"}],class:"form-control "+(t.hasError("more_details")?"is-invalid":""),attrs:{id:"schedule_record_more_details",maxlength:"250",placeholder:"Detalla el motivo"},domProps:{value:t.schedule_record.motive_details},on:{input:function(e){e.target.composing||t.$set(t.schedule_record,"motive_details",e.target.value)}}}),t._v(" "),r("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.errors.motive_details[0])}})])]),t._v(" "),r("div",{staticClass:"text-center"},[r("button",{staticClass:"btn btn-primary",on:{click:function(e){return e.preventDefault(),t.submitSignIn()}}},[t._v("Aceptar")])])])])])])]),t._v(" "),-1!=["initial","sent","fatal-error"].indexOf(t.status)?r("div",{staticClass:"card-body text-center justify-content-center align-items-center d-flex"},[r("span",{directives:[{name:"show",rawName:"v-show",value:"initial"==t.status,expression:"status == 'initial'"}],staticClass:"lead p-4"},[t._v("Cargando...")]),t._v(" "),"fatal-error"==t.status?r("span",{staticClass:"lead p-4"},[t._v("\n                "+t._s(t.message)+"\n            ")]):t._e(),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:"sent"==t.status,expression:"status == 'sent'"}],staticClass:"p-4"},[r("h5",{staticClass:"font-weight-bold"},[t._v("Hemos recibido tu ficha de hoy.")]),t._v(" "),r("p",{staticClass:"m-1"},[t._v("Gracias por tu colaboración")]),t._v(" "),r("p",{staticClass:"m-1"},[t._v(t._s(t.info.current_date))])])]):t._e()]),t._v(" "),r("div",{staticClass:"modal fade",attrs:{id:"successModal",tabindex:"-1",role:"dialog","aria-labelledBy":"successModal","aria-hidden":"true"}},[r("div",{staticClass:"modal-dialog ",attrs:{role:"document"}},[r("div",{staticClass:"modal-content"},[t._m(3),t._v(" "),r("div",{staticClass:"modal-body text-left"},[1==t.schedule_record.executed?r("div",[r("h4",{staticClass:"m-0"},[t._v(t._s(t.info.current_date))]),t._v(" "),r("p",{staticClass:"lead m-0"},[t._v(t._s(t.info.hours))])]):r("div",[r("p",{staticClass:"font-weight-bold m-0"},[t._v(t._s(t.motive_list.some(function(t){return t.id==e.schedule_record.motive_id})&&t.motive_list.find(function(t){return t.id==e.schedule_record.motive_id}).title))]),t._v(" "),r("p",{staticClass:"m-0"},[t._v(t._s(t.schedule_record.motive_details))])]),t._v(" "),t._m(4)])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"modal-header"},[t("h4",{staticClass:"modal-title"},[this._v("Motivo")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"col-12"},[t("h6",{staticClass:"font-weight-bold"},[this._v("Horario #1")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"col-12"},[t("h6",{staticClass:"font-weight-bold"},[this._v("Horario #2")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"modal-header"},[t("h4",{staticClass:"modal-title"},[this._v("Gracias por su colaboración")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"text-center py-4"},[t("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal","aria-label":"Close"}},[this._v("Aceptar")])])}]};var S=s("VU/8")(P,N,!1,function(e){s("vHTb")},"data-v-2f000773",null).exports;r.a.use(c.a);var A=new c.a({routes:[{path:"/",name:"home",component:p},{path:"/login",name:"login",component:g},{path:"/secure",name:"secure",component:b,meta:{requiresAuth:!0}},{path:"/schedule",name:"schedule",component:S}]});A.beforeEach(function(e,t,s){if(e.matched.some(function(e){return e.meta.requiresAuth})){if(_.getters.isLoggedIn)return void s();s("/login")}else s()});var q=A,I=s("Zrlr"),H=s.n(I),M=function e(){H()(this,e)};M.login="/login";var R=M;s("K3J8"),s("qb6w");m.a.defaults.baseURL="https://enterprise-evansjavier.c9users.io/api/auth",window.axios=m.a,window.API=R,r.a.config.productionTip=!1,axios.defaults.baseURL="https://enterprise-evansjavier.c9users.io/api/auth",r.a.prototype.$http=axios;var L=localStorage.getItem("token");L&&(r.a.prototype.$http.defaults.headers.common.Authorization="Bearer "+L),console.log("token: ",L),new r.a({router:q,store:_,render:function(e){return e(l)}}).$mount("#app")},qb6w:function(e,t){},vHTb:function(e,t){},wbng:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.fb9cdd1950633bb4c032.js.map