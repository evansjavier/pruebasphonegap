webpackJsonp([1],{"0EnO":function(e,t){},BLTE:function(e,t){},C7yk:function(e,t){},DwKh:function(e,t){},"H7/h":function(e,t){},HR4L:function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("7+uW"),a=r("//Fk"),o=r.n(a),i={computed:{isLoggedIn:function(){return this.$store.getters.isLoggedIn},currentUser:function(){return this.$store.getters.user}},methods:{logout:function(){var e=this;this.$store.dispatch("logout").then(function(){e.$router.push("/login")})}},created:function(){this.$http.interceptors.response.use(void 0,function(e){return new o.a(function(t,r){throw 401===e.status&&e.config&&!e.config.__isRetryRequest&&this.$store.dispatch(logout),e})})}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("nav",{staticClass:"navbar navbar-expand-md navbar-light bg-white shadow-sm"},[r("div",{staticClass:"container"},[e.isLoggedIn?r("router-link",{staticClass:"nav-link",attrs:{to:{path:"/schedule"}}},[r("img",{staticClass:"d-inline-block",attrs:{src:"https://dataprolegal.com/wp-content/uploads/2018/06/Logo-comunidad_3.png",width:"auto",height:"45px"}})]):r("router-link",{staticClass:"navbar-brand",attrs:{to:{path:"/login"}}},[r("img",{staticClass:"d-inline-block",attrs:{src:"https://dataprolegal.com/wp-content/uploads/2018/06/Logo-comunidad_3.png",width:"auto",height:"45px"}})]),e._v(" "),e._m(0),e._v(" "),r("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarSupportedContent"}},[r("ul",{staticClass:"navbar-nav mr-auto"},[e.isLoggedIn?r("li",{staticClass:"nav-item"},[r("router-link",{staticClass:"nav-link",attrs:{to:{name:"schedule-records"}}},[e._v("\n                          Fichas\n                        ")])],1):e._e(),e._v(" "),e.isLoggedIn?r("li",{staticClass:"nav-item"},[r("router-link",{staticClass:"nav-link",attrs:{to:{name:"work-reports"}}},[e._v("\n                          Reportes\n                        ")])],1):e._e()]),e._v(" "),r("ul",{staticClass:"navbar-nav ml-auto"},[e.isLoggedIn?r("li",{staticClass:"nav-item dropdown"},[r("a",{staticClass:"nav-link dropdown-toggle",attrs:{id:"navbarDropdown",href:"#",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[e._v("\n                          "+e._s(e.currentUser&&e.currentUser.name||"usuario")+" "),r("span",{staticClass:"caret"})]),e._v(" "),r("div",{staticClass:"dropdown-menu dropdown-menu-right",attrs:{"aria-labelledby":"navbarDropdown"}},[r("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.logout(t)}}},[e._v("\n                              Cerrar sesión\n                          ")])])]):r("li",{staticClass:"nav-item"},[r("router-link",{staticClass:"nav-link",attrs:{to:{name:"login"}}},[e._v("\n                        Login\n                      ")])],1)])])],1)]),e._v(" "),r("main",{staticClass:"py-4"},[r("div",{staticClass:"container"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-12 col-md-10 offset-md-1"},[r("div",{staticClass:"alert-container"}),e._v(" "),r("router-view")],1)])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"}},[t("span",{staticClass:"navbar-toggler-icon"})])}]};var c=r("VU/8")(i,n,!1,function(e){r("TNeR"),r("C7yk")},null,null).exports,l=r("/ocq"),d=r("pFYg"),u=r.n(d),_=r("mvHQ"),m=r.n(_),v=r("NYxO"),h=r("mtWM"),p=r.n(h);s.a.use(v.a);var f=new v.a.Store({state:{status:"",token:localStorage.getItem("token")||"",user:localStorage.getItem("user")||{}},mutations:{auth_request:function(e){e.status="loading"},auth_success:function(e,t){e.status="success",e.token=t.token,e.user=t.user},auth_error:function(e){e.status="error"},logout:function(e){e.status="",e.token=""}},actions:{login:function(e,t){var r=e.commit;return new o.a(function(e,s){r("auth_request"),p()({url:API.login,data:t,method:"POST"}).then(function(t){var s=t.data.access_token,a=t.data.user;localStorage.setItem("token",s),localStorage.setItem("user",m()(a)),p.a.defaults.headers.common.Authorization="Bearer "+s,r("auth_success",{token:t.data.access_token,user:t.data.user}),e(t)}).catch(function(e){console.log("STORE: login error",e),r("auth_error"),localStorage.removeItem("token"),s(e)})})},logout:function(e){var t=e.commit;return new o.a(function(e,r){t("logout"),localStorage.removeItem("token"),localStorage.removeItem("user"),delete p.a.defaults.headers.common.Authorization,e()})}},getters:{isLoggedIn:function(e){return!!e.token},authStatus:function(e){return e.status},user:function(e){return u()(e.user)==u()("")?JSON.parse(e.user):e.user}}}),g={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h1",[this._v("The Home")])])}]},b=(r("VU/8")(null,g,!1,null,null,null).exports,{data:function(){return{email:"",password:"",remember_me:"",errors:{email:[],password:[],remember_me:[]}}},methods:{login:function(){var e=this,t=this.email,r=this.password,s=this;for(var a in this.errors)this.errors[a]=[];this.$store.dispatch("login",{email:t,password:r}).then(function(){return e.$router.push("/schedule")}).catch(function(e){console.log(e);var t=e.response.data.errors;422==e.response.status&&t?(t.email&&(s.errors.email=t.email),t.password&&(s.errors.password=t.password),t.remember_me&&(s.errors.remember_me=t.remember_me)):401==e.response.status?(s.errors.email=["Estas credenciales no coinciden con nuestros registros."],s.password=""):alert("Hubo un error, por favor intente más tarde...")})}}}),C={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("div",{staticClass:"row justify-content-center"},[r("div",{staticClass:"col"},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-header"},[e._v("Acceder")]),e._v(" "),r("div",{staticClass:"card-body"},[r("form",{on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-md-4 col-form-label text-md-right",attrs:{for:"email"}},[e._v("Correo electrónico")]),e._v(" "),r("div",{staticClass:"col-md-6"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"form-control",class:{"is-invalid":e.errors.email.length},attrs:{id:"email",type:"email",name:"email",autocomplete:"email",required:"",autofocus:""},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._v(" "),e._l(e.errors.email,function(t){return r("span",{staticClass:"invalid-feedback",attrs:{role:"alert"}},[r("strong",[e._v(e._s(t))])])})],2)]),e._v(" "),r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-md-4 col-form-label text-md-right",attrs:{for:"password"}},[e._v("Contraseña")]),e._v(" "),r("div",{staticClass:"col-md-6"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",class:{"is-invalid":e.errors.password.length},attrs:{id:"password",type:"password",name:"password",required:"",autocomplete:"current-password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),e._l(e.errors.password,function(t){return r("span",{staticClass:"invalid-feedback",attrs:{role:"alert"}},[r("strong",[e._v(e._s(t))])])})],2)]),e._v(" "),r("div",{staticClass:"form-group row"},[r("div",{staticClass:"col-md-6 offset-md-4"},[r("div",{staticClass:"form-check"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.remember_me,expression:"remember_me"}],staticClass:"form-check-input",attrs:{type:"checkbox",name:"remember",id:"remember"},domProps:{checked:Array.isArray(e.remember_me)?e._i(e.remember_me,null)>-1:e.remember_me},on:{change:function(t){var r=e.remember_me,s=t.target,a=!!s.checked;if(Array.isArray(r)){var o=e._i(r,null);s.checked?o<0&&(e.remember_me=r.concat([null])):o>-1&&(e.remember_me=r.slice(0,o).concat(r.slice(o+1)))}else e.remember_me=a}}}),e._v(" "),r("label",{staticClass:"form-check-label",attrs:{for:"remember"}},[e._v("\n                                        Recuérdame\n                                    ")]),e._v(" "),e._l(e.errors.remember_me,function(t){return r("span",{staticClass:"invalid-feedback",attrs:{role:"alert"}},[r("strong",[e._v(e._s(t))])])})],2)])]),e._v(" "),e._m(0)])])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"form-group row mb-0"},[t("div",{staticClass:"col-md-8 offset-md-4"},[t("button",{staticClass:"btn btn-primary"},[this._v("\n                                    Acceder\n                                ")])])])}]};var w=r("VU/8")(b,C,!1,function(e){r("HR4L")},null,null).exports,x={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h1",[this._v("This page is protected by auth")])])}]},y=(r("VU/8")(null,x,!1,null,null,null).exports,r("woOf")),k=r.n(y),E=r("7t+N"),R=r.n(E),S={watch:{status:function(){console.log(this.status)},schedule_record:{handler:function(){1==this.schedule_record.executed&&(this.schedule_record.motive_id=null,this.schedule_record.motive_details=null,this.submitSignIn())},deep:!0}},data:function(){return{status:"initial",errors:{executed:[],motive_id:[],motive_details:[],entry_time:[],departure_time:[],sec_entry_time:[],sec_departure_time:[]},schedule_record:{executed:null,motive_id:"",motive_details:null,entry_time:null,departure_time:null,sec_entry_time:null,sec_departure_time:null},info:{current_date:"",hours:""},message:"",motive_list:[]}},mounted:function(){var e=this;axios.get("schedule-records/today").then(function(t){var r=t.data;"undefined"==u()(r.id)?(e.status="ready",e.fillMotives(),e.schedule_record=k()(e.schedule_record,{entry_time:r.schedule_entry_time,departure_time:r.schedule_departure_time,sec_entry_time:r.sec_schedule_entry_time,sec_departure_time:r.sec_schedule_departure_time})):e.status="sent",e.info=k()(r,{current_date:r.date,hours:r.schedule})}).catch(function(t){switch(e.status="fatal-error",t.response.status){case 400:case 403:e.message=t.response.data.message;break;default:e.message="Ha ocurrido un error inesperado, si este persiste contacte con el administrador del sistema."}})},methods:{expandDetails:function(){var e=R()("#schedule_record_motive").find('option[value="'+this.schedule_record.motive_id+'"]'),t=R()("#schedule_record_more_details");e.length>0&&e.attr("need_details")>0?t.parents(".more-details-container").slideDown():t.parents(".more-details-container").slideUp()},submitSignIn:function(){var e=this;if("submitting"==e.status)return console.log("please wait..."),!1;e.status="submitting",e.resetErrors();var t=new URLSearchParams;t.append("executed",e.schedule_record.executed?e.schedule_record.executed:""),t.append("motive_id",e.schedule_record.motive_id?e.schedule_record.motive_id:""),t.append("motive_details",e.schedule_record.motive_details?e.schedule_record.motive_details:""),t.append("entry_time",e.schedule_record.entry_time?e.schedule_record.entry_time:""),t.append("departure_time",e.schedule_record.departure_time?e.schedule_record.departure_time:""),t.append("sec_entry_time",e.schedule_record.sec_entry_time?e.schedule_record.sec_entry_time:""),t.append("sec_departure_time",e.schedule_record.sec_departure_time?e.schedule_record.sec_departure_time:""),axios.post("sign-on",t).then(function(r){R()("#motiveModal").modal("hide"),R()("#successModal").modal(),e.status="sent",console.log(t)}).catch(function(t,r){switch(e.status="error",t.response.status){case 422:e.errors=k()(e.errors,t.response.data.errors);break;default:alert("Ha ocurrido un error inesperado, si el error persiste contacta con el administrador del sistema.")}})},fillMotives:function(){var e=this,t=[];axios.get("motive/list").then(function(e){t=e.data}).catch(function(e){e.response.status,t={id:null,title:"Ocurrio un error al buscar los motivos de tu empresa.",need_details:!1}}).then(function(){e.motive_list=t})},hasError:function(e){return this.errors[e]&&this.errors[e].length>0},resetErrors:function(){var e={};for(var t in this.errors)e[t]=[];this.errors=k()(this.errors,e)}}},H={render:function(){var e=this,t=this,r=t.$createElement,s=t._self._c||r;return s("div",{staticClass:"text-center"},[s("div",{},[s("div",{directives:[{name:"show",rawName:"v-show",value:-1!=["ready","submitting","error"].indexOf(t.status),expression:"['ready', 'submitting', 'error'].indexOf(status) != -1 "}],staticClass:"card-body"},[s("div",{staticClass:" text-center"},[s("h2",[t._v(t._s(t.info.current_date))]),t._v(" "),s("p",{staticClass:"lead mb-2"},[t._v("¿Ha realizado este horario?")]),t._v(" "),s("p",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t.info.hours))]),t._v(" "),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-auto"},[s("label",{staticClass:"btn btn-success exec-btn"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.executed,expression:"schedule_record.executed"}],attrs:{type:"radio",value:"1"},domProps:{checked:t._q(t.schedule_record.executed,"1")},on:{change:function(e){return t.$set(t.schedule_record,"executed","1")}}}),t._v("\n                            Si\n                        ")])]),t._v(" "),s("div",{staticClass:"col-auto"},[s("label",{staticClass:"btn btn-danger exec-btn",attrs:{"data-toggle":"modal","data-target":"#motiveModal"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.executed,expression:"schedule_record.executed"}],attrs:{type:"radio",value:"0"},domProps:{checked:t._q(t.schedule_record.executed,"0")},on:{change:function(e){return t.$set(t.schedule_record,"executed","0")}}}),t._v("\n                            No\n                        ")])]),t._v(" "),s("div",{staticClass:"col-12"},[s("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.errors.executed[0])}})])])]),t._v(" "),s("div",{staticClass:"modal fade",attrs:{id:"motiveModal",tabindex:"-1",role:"dialog","aria-labelledBy":"motiveModal","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog ",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),s("div",{staticClass:"modal-body"},[s("div",{staticClass:"form-group"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.motive_id,expression:"schedule_record.motive_id"}],class:"form-control "+(t.hasError("motive_id")?"is-invalid":""),attrs:{id:"schedule_record_motive"},on:{change:[function(e){var r=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});t.$set(t.schedule_record,"motive_id",e.target.multiple?r:r[0])},function(e){return t.expandDetails()}]}},[s("option",{attrs:{value:"",disabled:""}},[t._v("Seleccione un motivo")]),t._v(" "),t._l(t.motive_list,function(e){return s("option",{attrs:{need_details:e.need_details?1:0},domProps:{value:e.id}},[t._v(t._s(e.title))])})],2),t._v(" "),s("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.errors.motive_id[0])}})]),t._v(" "),s("div",{staticClass:"more-details-container",staticStyle:{display:"none"}},[s("div",{staticClass:"form-group row text-left"},[t._m(1),t._v(" "),s("div",{staticClass:"col"},[s("label",[t._v("Hora de entrada")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.entry_time,expression:"schedule_record.entry_time"}],class:"form-control form-control-sm "+(t.hasError("entry_time")?"is-invalid":""),attrs:{type:"time",placeholder:"00:00",required:""},domProps:{value:t.schedule_record.entry_time},on:{input:function(e){e.target.composing||t.$set(t.schedule_record,"entry_time",e.target.value)}}}),t._v(" "),s("span",{staticClass:"text-danger small",domProps:{textContent:t._s(t.errors.entry_time[0])}})]),t._v(" "),s("div",{staticClass:"col"},[s("label",[t._v("Hora de salida")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.departure_time,expression:"schedule_record.departure_time"}],class:"form-control form-control-sm "+(t.hasError("departure_time")?"is-invalid":""),attrs:{type:"time",placeholder:"00:00",required:""},domProps:{value:t.schedule_record.departure_time},on:{input:function(e){e.target.composing||t.$set(t.schedule_record,"departure_time",e.target.value)}}}),t._v(" "),s("span",{staticClass:"text-danger small",domProps:{textContent:t._s(t.errors.departure_time[0])}})])]),t._v(" "),t.info.sec_schedule_entry_time&&t.info.sec_schedule_departure_time?s("div",{staticClass:"form-group row text-left"},[t._m(2),t._v(" "),s("div",{staticClass:"col"},[s("label",[t._v("Hora de entrada")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.sec_entry_time,expression:"schedule_record.sec_entry_time"}],class:"form-control form-control-sm "+(t.hasError("sec_entry_time")?"is-invalid":""),attrs:{type:"time",placeholder:"00:00",required:""},domProps:{value:t.schedule_record.sec_entry_time},on:{input:function(e){e.target.composing||t.$set(t.schedule_record,"sec_entry_time",e.target.value)}}}),t._v(" "),s("span",{staticClass:"text-danger small",domProps:{textContent:t._s(t.errors.sec_entry_time[0])}})]),t._v(" "),s("div",{staticClass:"col"},[s("label",[t._v("Hora de salida")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.sec_departure_time,expression:"schedule_record.sec_departure_time"}],class:"form-control form-control-sm "+(t.hasError("sec_departure_time")?"is-invalid":""),attrs:{type:"time",placeholder:"00:00",required:""},domProps:{value:t.schedule_record.sec_departure_time},on:{input:function(e){e.target.composing||t.$set(t.schedule_record,"sec_departure_time",e.target.value)}}}),t._v(" "),s("span",{staticClass:"text-danger small",domProps:{textContent:t._s(t.errors.sec_departure_time[0])}})])]):t._e(),t._v(" "),s("div",{staticClass:"form-group"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.schedule_record.motive_details,expression:"schedule_record.motive_details"}],class:"form-control "+(t.hasError("more_details")?"is-invalid":""),attrs:{id:"schedule_record_more_details",maxlength:"250",placeholder:"Detalla el motivo"},domProps:{value:t.schedule_record.motive_details},on:{input:function(e){e.target.composing||t.$set(t.schedule_record,"motive_details",e.target.value)}}}),t._v(" "),s("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.errors.motive_details[0])}})])]),t._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-primary",on:{click:function(e){return e.preventDefault(),t.submitSignIn()}}},[t._v("Aceptar")])])])])])])]),t._v(" "),-1!=["initial","sent","fatal-error"].indexOf(t.status)?s("div",{staticClass:"card-body text-center justify-content-center align-items-center d-flex"},[s("span",{directives:[{name:"show",rawName:"v-show",value:"initial"==t.status,expression:"status == 'initial'"}],staticClass:"lead p-4"},[t._v("Cargando...")]),t._v(" "),"fatal-error"==t.status?s("span",{staticClass:"lead p-4"},[t._v("\n                "+t._s(t.message)+"\n            ")]):t._e(),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:"sent"==t.status,expression:"status == 'sent'"}],staticClass:"p-4"},[s("h5",{staticClass:"font-weight-bold"},[t._v("Hemos recibido tu ficha de hoy.")]),t._v(" "),s("p",{staticClass:"m-1"},[t._v("Gracias por tu colaboración")]),t._v(" "),s("p",{staticClass:"m-1"},[t._v(t._s(t.info.current_date))])])]):t._e()]),t._v(" "),s("div",{staticClass:"modal fade",attrs:{id:"successModal",tabindex:"-1",role:"dialog","aria-labelledBy":"successModal","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog ",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[t._m(3),t._v(" "),s("div",{staticClass:"modal-body text-left"},[1==t.schedule_record.executed?s("div",[s("h4",{staticClass:"m-0"},[t._v(t._s(t.info.current_date))]),t._v(" "),s("p",{staticClass:"lead m-0"},[t._v(t._s(t.info.hours))])]):s("div",[s("p",{staticClass:"font-weight-bold m-0"},[t._v(t._s(t.motive_list.some(function(t){return t.id==e.schedule_record.motive_id})&&t.motive_list.find(function(t){return t.id==e.schedule_record.motive_id}).title))]),t._v(" "),s("p",{staticClass:"m-0"},[t._v(t._s(t.schedule_record.motive_details))])]),t._v(" "),t._m(4)])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"modal-header"},[t("h4",{staticClass:"modal-title"},[this._v("Motivo")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"col-12"},[t("h6",{staticClass:"font-weight-bold"},[this._v("Horario #1")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"col-12"},[t("h6",{staticClass:"font-weight-bold"},[this._v("Horario #2")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"modal-header"},[t("h4",{staticClass:"modal-title"},[this._v("Gracias por su colaboración")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"text-center py-4"},[t("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal","aria-label":"Close"}},[this._v("Aceptar")])])}]};var N=r("VU/8")(S,H,!1,function(e){r("j8/E")},"data-v-e47f5b3c",null).exports,P=(r("jCvU"),{mounted:function(){var e=this;$(this.$refs.div).on("click",".action.action-view",function(){var t=$(this).parents("tr").find("td").first().text();console.log(t),t&&e.$router.push({name:"schedule-records.show",params:{id:t}})}),$("table").dataTable({processing:!0,serverSide:!0,pageLength:5,lengthMenu:[],searching:!0,ajax:{dataType:"json",headers:{Authorization:"Bearer "+localStorage.getItem("token")},url:axios.defaults.baseURL+"/schedule-records"},columns:[{data:"id"},{data:"date"},{data:"schedule"},{data:"executed",render:function(e){return e>0?"Si":"No"}},{data:null,defaultContent:'<div class="d-flex justify-content-center"> <btn class="action action-view btn btn-sm btn-primary" title="Ver"><i class="oi oi-eye"></i></btn></div>'}],initComplete:function(){var t=this.api().init().columns;this.api().columns().every(function(e){var r,s=this;switch(t[e].data){case"date":r=$("<input>").attr({type:"date",class:"form-control form-control-sm"});break;case"executed":r=$("<select></select>").attr({class:"form-control form-control-sm"});var a={0:"No",1:"Si"};for(var o in a)$("<option></option>").attr({value:o}).text(a[o]).appendTo(r);break;default:return}r.appendTo($(s.footer()).empty()).on("change",function(){s.search($(this).val(),!1,!1,!0).draw()})}),$(e.$refs["table-container"]).find("table").parent().addClass("table-responsive")}})}}),U={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{ref:"div",staticClass:"card"},[this._m(0),this._v(" "),t("div",{staticClass:"card-body"},[t("div",{ref:"table-container"},[t("table",{ref:"table",staticClass:"table table-striped w-100"},[this._m(1),this._v(" "),this._m(2)])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"card-header"},[t("h5",[this._v("Fichas")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",[r("tr",[r("th",[e._v("#")]),e._v(" "),r("th",[e._v("Fecha")]),e._v(" "),r("th",[e._v("Horario")]),e._v(" "),r("th",[e._v("Realizado")]),e._v(" "),r("th")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tfoot",[r("tr",[r("th",[e._v("#")]),e._v(" "),r("th",[e._v("Fecha")]),e._v(" "),r("th",[e._v("Horario")]),e._v(" "),r("th",[e._v("Realizado")]),e._v(" "),r("th")])])}]};var I=r("VU/8")(P,U,!1,function(e){r("BLTE")},null,null).exports,F={props:{id:{required:!0}},data:function(){return{schedule_record:{}}},beforeMount:function(){this.fetchRecord()},methods:{fetchRecord:function(){var e=this;axios.get("schedule-records/"+e.id).then(function(t){console.log(t),e.schedule_record=k()({},t.data),console.log(e.schedule_record,e.schedule_record.id)}).catch(function(e){console.log(e.response),e.response.status,alert("Ha ocurrido un error inesperado, si el error persiste contacte con el administrador del sistema.")})}}},L={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"div",staticClass:"card"},[r("div",{staticClass:"card-header"},[r("h5",[e._v("Ficha #"+e._s(e.id))])]),e._v(" "),r("div",{staticClass:"card-body"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col col-md-8 offset-md-2"},[void 0===e.schedule_record.id?r("div",{staticClass:"text-center m-5"},[e._v("Cargando...")]):r("div",{staticClass:"table-responsive"},[r("table",{staticClass:"table table-striped"},[r("tbody",[r("tr",[r("th",[e._v("Empresa")]),e._v(" "),r("td",[e._v(e._s(e.schedule_record.company.name))])]),e._v(" "),r("tr",[r("th",[e._v("Usuario")]),e._v(" "),r("td",[e._v(e._s(e.schedule_record.user.full_name))])]),e._v(" "),r("tr",[r("th",[e._v("Fecha")]),e._v(" "),r("td",[e._v(e._s(e.schedule_record.date))])]),e._v(" "),r("tr",[r("th",[e._v("Horario")]),e._v(" "),r("td",[e._v(e._s(e.schedule_record.schedule))])]),e._v(" "),r("tr",[r("th",[e._v("Horario Realizado")]),e._v(" "),r("td",[e._v(e._s(e.schedule_record.working_schedule))])]),e._v(" "),r("tr",[r("th",[e._v("Horas")]),e._v(" "),r("td",[e._v(e._s(e.schedule_record.working_hours))])]),e._v(" "),r("tr",[r("th",[e._v("Realizado")]),e._v(" "),r("td",[e._v(e._s(e.schedule_record.executed?"Si":"No"))])]),e._v(" "),e.schedule_record.executed?e._e():r("tr",[r("th",[e._v("Motivo")]),e._v(" "),r("td",[r("b",[e._v(e._s(e.schedule_record.motive))]),e._v(" "),r("br"),e._v(" "),r("i",[e._v(e._s(e.schedule_record.motive_details))])])])])])]),e._v(" "),r("div",{staticClass:"text-center"},[r("a",{staticClass:"btn btn-default",on:{click:function(t){return e.$router.go(-1)}}},[e._v("Regresar")])])])])])])},staticRenderFns:[]};var T=r("VU/8")(F,L,!1,function(e){r("H7/h")},null,null).exports,A={mounted:function(){var e=this;$(this.$refs.div).on("click",".action.action-view",function(){var t=$(this).parents("tr").find("td").first().text();t&&e.$router.push({name:"work-reports.show",params:{id:t}})}),$("table").dataTable({processing:!0,serverSide:!0,pageLength:5,lengthMenu:[],searching:!0,ajax:{dataType:"json",headers:{Authorization:"Bearer "+localStorage.getItem("token")},url:axios.defaults.baseURL+"/work-reports"},columns:[{data:"id"},{data:function(e,t,r,s){switch(e.state){case"PENDING":return"Pendiente";case"SIGNED":return"Firmado";default:return"-"}},name:"state"},{data:function(e,t,r,s){try{return new Date(e.report_date.date).toLocaleDateString()}catch(t){return e.report_date.date}},name:"report_date"},{data:null,defaultContent:'<div class="d-flex justify-content-center"> <btn class="action action-view btn btn-sm btn-primary" title="Ver"><i class="oi oi-eye"></i></btn></div>'}],initComplete:function(){var t=this.api().init().columns;this.api().columns().every(function(e,r){var s,a=this;switch(t[e].name||t[e].data){case"report_date":s=$("<input>").attr({type:"date",class:"form-control form-control-sm"});break;case"state":s=$("<select></select>").attr({class:"form-control form-control-sm"});var o={"-":null,Pendiente:"PENDING",Firmado:"SIGNED"};for(var i in o)$("<option></option>").attr({value:o[i]}).text(i).appendTo(s);break;default:return}s.appendTo($(a.footer()).empty()).on("change",function(){a.search($(this).val(),!1,!1,!0).draw()})}),$(e.$refs["table-container"]).find("table").parent().addClass("table-responsive")}})}},D={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{ref:"div",staticClass:"card"},[this._m(0),this._v(" "),t("div",{staticClass:"card-body"},[t("div",{ref:"table-container"},[t("table",{ref:"table",staticClass:"table table-striped w-100"},[this._m(1),this._v(" "),this._m(2)])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"card-header"},[t("h5",[this._v("Reportes")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("#")]),this._v(" "),t("th",[this._v("Estado")]),this._v(" "),t("th",[this._v("Fecha")]),this._v(" "),t("th")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tfoot",[t("tr",[t("th",[this._v("#")]),this._v(" "),t("th",[this._v("Estado")]),this._v(" "),t("th",[this._v("Fecha")]),this._v(" "),t("th")])])}]},M=r("VU/8")(A,D,!1,null,null,null).exports,j={props:{id:{required:!0}},data:function(){return{work_report:{}}},computed:{pdfUrl:function(){return window.baseURL+"/work-reports/"+this.work_report.uuid+"/pdf"}},beforeMount:function(){this.fetchRecord()},methods:{fetchRecord:function(){var e=this;axios.get("work-reports/"+e.id).then(function(t){console.log(t),e.work_report=k()({},t.data),console.log(e.work_report,e.work_report.id)}).catch(function(e){console.log(e.response),e.response.status,alert("Ha ocurrido un error inesperado, si el error persiste contacte con el administrador del sistema.")})}}},q={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"div",staticClass:"card"},[r("div",{staticClass:"card-header"},[e.work_report.id?r("h5",[r("span",{staticClass:"float-right"},[r("a",{staticClass:"action btn btn-sm btn-danger mr-2",attrs:{href:e.pdfUrl,title:"Ver PDF"}},[r("i",{staticClass:"oi oi-document"})])]),e._v("\n            Reporte de "+e._s(e.work_report.user.full_name)+" | "+e._s(e.work_report.date)+"\n        ")]):r("h5",[e._v("Cargando...")])]),e._v(" "),r("div",{staticClass:"card-body"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col"},[e.work_report.id?r("work-report-details",{attrs:{work_report:e.work_report,actions:1}}):r("div",{staticClass:"text-center m-5"},[e._v("Cargando...")]),e._v(" "),r("div",{staticClass:"text-center"},[r("a",{staticClass:"btn btn-default",on:{click:function(t){return e.$router.go(-1)}}},[e._v("Regresar")])])],1)])])])},staticRenderFns:[]},V=r("VU/8")(j,q,!1,null,null,null).exports,O={name:"ReportToSign",data:function(){return{work_report:!1,canvas:null,firmado:!1}},computed:{user:function(){return this.$store.getters.user},user_fullname:function(){return this.$store.getters.user.name+" "+this.$store.getters.user.last_name},company_name:function(){return this.$store.getters.user.company_name}},created:function(){var e=this;e.$http.get("work_report_to_sign").then(function(t){t.data.id&&(e.work_report=k()({},t.data),console.log("reporte",e.work_report))}).catch(function(e,t){switch(console.log(e),e.response.status){case 422:break;default:alert("Ha ocurrido un error inesperado, si el error persiste contacta con el administrador del sistema."),console.log("Error: ",e.response.status)}})},mounted:function(){},updated:function(){this.work_report.id&&($(this.$refs["modal-firma"]).modal({show:!0}),z(this),this.canvas=this.$refs.canvas_sign)},methods:{__:function(e){return e},firmarReporte:function(e){var t=this,r=this.canvas.toDataURL(),s=new URLSearchParams;s.append("sign",r),this.firmado?this.$http.post("/work-reports/"+e+"/sign",s).then(function(e){$("#modal-firma").modal("hide"),alert("Se ha guardado la firma."),t.$router.go()}).catch(function(e){alert("Hubo un error."),console.log(e)}):alert("Por favor, firme primero...")}}},z=function(e){var t=document.getElementById("firma");console.log(e,"firma","HEy",e.$refs.canvas_sign,document.getElementById("firma")),e.firmado=!1;var r,s=t.getContext("2d"),a=[],o=[],i=[],n=function(e,t,r){e<0&&(e=t=NaN),a.push(e),o.push(t),i.push(r)},c=function(){l(),s.strokeStyle="#111",s.lineJoin="round",s.lineWidth=.0085*t.getAttribute("height");for(var e=0;e<a.length;e++)s.beginPath(),i[e]&&e?s.moveTo(a[e-1],o[e-1]):s.moveTo(Math.abs(a[e]-1),Math.abs(o[e])),s.lineTo(a[e],o[e]),s.closePath(),s.stroke()},l=function(){s.clearRect(0,0,1.5*$(t).outerWidth(),1.5*$(t).outerHeight())},d=function(){var e=t.getAttribute("height");t.setAttribute("height",$("#firma").innerHeight()),t.setAttribute("width",$("#firma").innerWidth()),s=t.getContext("2d");for(var r=t.getAttribute("height")/e,i=0;i<a.length;i++)a[i]=a[i]*r,o[i]=o[i]*r;c()};$("#firma").on("mousedown touchstart",function(e){console.log("start"),r=!0;var t=e.pageX-$(this).offset().left,s=e.pageY-$(this).offset().top;n(t,s),c()}).on("mouseleave mouseup touchend touchleave",function(){r=!1}).on("mousemove touchmove",function(t){t.preventDefault();var s=t.pageX||t.originalEvent.touches[0].pageX,a=t.pageY||t.originalEvent.touches[0].pageY;if(r){var o=s-$(this).offset().left,i=a-$(this).offset().top;n(o,i,!0),c(),e.firmado=!0}}),$("#modal-firma").modal({show:!0,onOpenEnd:function(){d()}}),$("#desea-firmar .modal-trigger").on("click",function(){setTimeout(d,250)}),$("#reset-firma").on("click",function(){console.log("limpiando.."),l(),a=[],o=[],i=[],e.firmado=!1})},B={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"modal-firma",staticClass:"modal fade",attrs:{id:"modal-firma",tabindex:"-1",role:"dialog","aria-labelledby":"signReportModalTitle","aria-hidden":"true"}},[r("div",{staticClass:"modal-dialog mx-auto",staticStyle:{"max-width":"90%"},attrs:{role:"document"}},[r("div",{staticClass:"modal-content"},[e._m(0),e._v(" "),r("div",{staticClass:"modal-body"},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-header text-center"},[e.work_report.id?r("h5",[e._v("Reporte de "+e._s(e.work_report.user.full_name)+" | "+e._s(e.work_report.date))]):r("h5",[e._v("Cargando...")])]),e._v(" "),r("div",{staticClass:"card-body"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-10 offset-md-1"},[e.work_report.id?r("work-report-details",{attrs:{work_report:e.work_report}}):r("div",{staticClass:"text-center m-5"},[e._v("Cargando...")])],1)])])]),e._v(" "),e.work_report.id?r("div",{staticClass:"text-center"},[r("h6",{staticClass:"text-center my-4"},[e._v("Por favor, firme si está de acuerdo:")]),e._v(" "),r("canvas",{ref:"canvas_sign",staticClass:"mx-auto d-block",staticStyle:{border:"2px solid black","max-width":"100%"},attrs:{id:"firma",width:"320",height:"180"}}),e._v(" "),r("button",{staticClass:"btn btn-xs mt-2",attrs:{id:"reset-firma"}},[e._v("Limpiar")])]):e._e()]),e._v(" "),r("div",{staticClass:"modal-footer"},[r("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[e._v("Salir")]),e._v(" "),e.work_report.id?r("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(t){return e.firmarReporte(e.work_report.id)}}},[e._v("Guardar")]):e._e()])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"modal-header"},[t("h5",{staticClass:"modal-title text-center",attrs:{id:"signReportModalTitle"}},[t("b",[this._v("Tienes un reporte por firmar")])]),this._v(" "),t("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[t("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])])}]};var G={computed:{user_fullname:function(){return this.$store.getters.user.name+" "+this.$store.getters.user.last_name},company_name:function(){return this.$store.getters.user.company_name}},name:"schedule-view",components:{ScheduleRecordForm:N,ReportToSign:r("VU/8")(O,B,!1,function(e){r("mDrZ")},"data-v-46bac7f1",null).exports}},J={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("div",{staticClass:"row justify-content-center"},[r("div",{staticClass:"col"},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-header"},[e._v("Bienvenido, "+e._s(e.user_fullname))]),e._v(" "),r("div",{staticClass:"card-body"},[e._e(),e._v(" "),r("div",{staticClass:"text-center"},[r("p",{staticClass:"m-0 font-weight-bold"},[e._v("Empleado")]),e._v(" "),r("p",{},[e._v(e._s(e.user_fullname)+" ")]),e._v(" "),r("p",{staticClass:"m-0 font-weight-bold"},[e._v("Empresa")]),e._v(" "),r("p",[e._v(e._s(e.company_name))])]),e._v(" "),r("ScheduleRecordForm")],1),e._v(" "),e._m(0)])])]),e._v(" "),r("ReportToSign")],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"card-footer text-center border-none"},[this._v("\n                    Si tienes alguna duda o consulta puedes escribirnos a "),t("a",{attrs:{href:"mailto:contacto@dataprolegal.com"}},[this._v("contacto@dataprolegal.com")])])}]},W=r("VU/8")(G,J,!1,null,null,null).exports;s.a.use(l.a);var Y=new l.a({routes:[{path:"/",name:"home",component:w},{path:"/login",name:"login",component:w},{path:"/schedule",name:"schedule",component:W},{path:"/schedule-records",name:"schedule-records",component:I},{path:"/schedule-records/:id",name:"schedule-records.show",component:T,props:!0},{path:"/work-reports",name:"work-reports",component:M},{path:"/work-reports/:id",name:"work-reports.show",component:V,props:!0}]});Y.beforeEach(function(e,t,r){if($("body").width()<768&&$("#navbarSupportedContent").hasClass("show")&&$("#navbarSupportedContent").siblings("[data-toggle]").click(),e.matched.some(function(e){return e.meta.requiresAuth})){if(f.getters.isLoggedIn)return void r();r("/login")}else r()});var K=Y,Z=r("Zrlr"),X=r.n(Z),Q=function e(){X()(this,e)};Q.login="/login";var ee=Q;r("K3J8"),r("qb6w"),r("0EnO"),r("DwKh");r("kBzv"),window.axios=p.a,window.API=ee,window.baseURL="https://dataprocontrol.presencialaboral.es",window.apiURL=window.baseURL+"/api",s.a.config.productionTip=!1,s.a.component("work-report-details",r("UNb1").default),axios.defaults.baseURL=window.baseURL+"/api/auth",s.a.prototype.$http=axios;var te=localStorage.getItem("token");te&&(s.a.prototype.$http.defaults.headers.common.Authorization="Bearer "+te),new s.a({router:K,store:f,render:function(e){return e(c)}}).$mount("#app")},TNeR:function(e,t){},UNb1:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={props:{work_report:{type:Object,required:!0},actions:{default:!1}}},a={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h4",[e._v("Empresa / Trabajador")]),e._v(" "),r("div",{staticClass:"table-responsive"},[r("table",{staticClass:"table table-striped table-sm"},[r("tbody",[r("tr",[r("th",[e._v("Empresa")]),e._v(" "),r("td",[e._v(e._s(e.work_report.user.companies.map(function(e){return e.name}).join(",")))]),e._v(" "),r("th",[e._v("Usuario")]),e._v(" "),r("td",[e._v(e._s(e.work_report.user.full_name))])]),e._v(" "),r("tr",[r("th",[e._v("CIF")]),e._v(" "),r("td",[e._v(e._s(e.work_report.user.companies.map(function(e){return e.cif}).join(",")))]),e._v(" "),r("th",[e._v("CIF")]),e._v(" "),r("td",[e._v(e._s(e.work_report.user.dni))])])])]),e._v(" "),e.work_report.is_signed?r("p",[e._v("Firmado el "+e._s(e.work_report.signed_at.date))]):e._e()]),e._v(" "),r("h4",[e._v("Jornadas Realizadas")]),e._v(" "),r("div",{staticClass:"table-responsive",attrs:{id:"data-table"}},[r("table",{staticClass:"table table-striped table-bordered table-sm text-center"},[r("thead",[r("tr",[r("th",{attrs:{rowspan:"2"}},[e._v("Día")]),e._v(" "),r("th",{attrs:{colspan:"3"}},[e._v("Horario #1")]),e._v(" "),e.work_report.has_two_hours?r("th",{attrs:{colspan:"3"}},[e._v("Horario #2")]):e._e(),e._v(" "),e.actions?r("th",{attrs:{rowspan:"2"}},[e._v("Acciones")]):e._e()]),e._v(" "),r("tr",[r("th",[e._v("Hora de Entrada")]),e._v(" "),r("th",[e._v("Hora de Salida")]),e._v(" "),r("th",[e._v("Horas")]),e._v(" "),e.work_report.has_two_hours?r("th",[e._v("Hora de Entrada")]):e._e(),e._v(" "),e.work_report.has_two_hours?r("th",[e._v("Hora de Salida")]):e._e(),e._v(" "),e.work_report.has_two_hours?r("th",[e._v("Horas")]):e._e()])]),e._v(" "),r("tbody",e._l(e.work_report.schedule_records,function(t){return r("tr",[r("td",[e._v(e._s(t.date))]),e._v(" "),r("td",[e._v(e._s(t.entry_time))]),e._v(" "),r("td",[e._v(e._s(t.departure_time))]),e._v(" "),r("td",[e._v(e._s(t.first_working_hours))]),e._v(" "),e.work_report.has_two_hours?r("td",[e._v(e._s(t.sec_entry_time))]):e._e(),e._v(" "),e.work_report.has_two_hours?r("td",[e._v(e._s(t.sec_departure_time))]):e._e(),e._v(" "),e.work_report.has_two_hours?r("td",[e._v(e._s(t.second_working_hours))]):e._e(),e._v(" "),e.actions?r("td",[r("div",{staticClass:"d-md-flex justify-content-md-center"},[r("router-link",{staticClass:"action btn btn-sm btn-primary mr-2",attrs:{to:{name:"schedule-records.show",params:{id:t.id}},title:"Ver"}},[r("i",{staticClass:"oi oi-eye"})])],1)]):e._e()])}),0)])])])},staticRenderFns:[]},o=r("VU/8")(s,a,!1,null,null,null);t.default=o.exports},"j8/E":function(e,t){},kBzv:function(e,t,r){try{window.Popper=r("Zgw8").default,window.$=window.jQuery=r("7t+N"),r("K3J8")}catch(e){}},mDrZ:function(e,t){},qb6w:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.87f8410c65b25ff1e73f.js.map